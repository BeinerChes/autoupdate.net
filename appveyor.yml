version: 0.0.{build}
image: Visual Studio 2017
before_build:
  - cmd: cd src
  

build_script:
  - cmd: dotnet restore
  - cmd: dotnet build --configuration Release
  - cmd: dotnet pack AutoUpdate.Core\AutoUpdate.Core.csproj --configuration Release --include-symbols --no-build -p:PackageVersion=%APPVEYOR_BUILD_VERSION% --version-suffix %APPVEYOR_REPO_COMMIT%

test_script:
- cmd:  dotnet test test\AutoUpdate.Core.Tests\AutoUpdate.Core.Tests.csproj --configuration Release --no-build --test-adapter-path:. --logger:Appveyor

artifacts:
    - path: '**\*.nupkg'

#deploy:
#- provider: NuGet
#  api_key:
#    secure: wWeihuaKMEW1jQOjpZLZUAcgkPx3FX6OV2caW1zsvNWBIIZUQ2O5S+U2sbP9qDOf
#  artifact: /.*\.nupkg/
#  skip_symbols: true
#  on:
#    branch: master